define([], function () {
    var tracks = [{ "aid": 109005699, "owner_id": 111953916, "artist": "Nirvana", "title": "Smells Like Teen Spirit", "duration": 301, "url": "http:\/\/cs4649.vk.me\/u74982745\/audios\/6cad9dae4fad.mp3", "lyrics_id": "54997562" }, { "aid": 99380464, "owner_id": 6571745, "artist": "The Killers", "title": "Mr. Brightside ", "duration": 222, "url": "http:\/\/cs4628.vk.me\/u976645\/audios\/9b51e07c708c.mp3", "lyrics_id": "6614742", "album": "19443259" }, { "aid": 55787072, "owner_id": 1360359, "artist": "Nirvana ", "title": "Come as You Are", "duration": 218, "url": "http:\/\/cs508.vk.me\/u1360359\/audios\/d0ba5afcb982.mp3", "lyrics_id": "2304312" }, { "aid": 78105826, "owner_id": 103445, "artist": "Coldplay", "title": "Clocks", "duration": 307, "url": "http:\/\/cs4352.vk.me\/u2014467\/audios\/d472afc442ff.mp3", "lyrics_id": "2199338", "album": "302748" }, { "aid": 139821206, "owner_id": 162966744, "artist": "Lil Wyte", "title": "Smoke My Dro (Feat. Dirt Bag)", "duration": 180, "url": "http:\/\/cs5409.vk.me\/u162966744\/audios\/f77780b8b3ca.mp3" }, { "aid": 98439230, "owner_id": 63013039, "artist": "Miles Davis", "title": "Well, You Needn't  (Live at Hi-Hat Club, Boston MA, Febraury 1955)", "duration": 593, "url": "http:\/\/cs5118.vk.me\/u63013039\/audios\/43859aca3ac9.mp3", "album": "11610641" }, { "aid": 71163171, "owner_id": 2729225, "artist": "The Killers", "title": "Somebody Told Me", "duration": 197, "url": "http:\/\/cs4524.vk.me\/u2729225\/audios\/d87df3838cd2.mp3", "lyrics_id": "3283025" }, { "aid": 68642962, "owner_id": 1654626, "artist": "Franz Ferdinand", "title": "Take Me Out", "duration": 237, "url": "http:\/\/cs4488.vk.me\/u1654626\/audios\/17e4f4a4ad7d.mp3", "lyrics_id": "2856255" }, { "aid": 84199575, "owner_id": 7843745, "artist": "Coldplay", "title": "Viva la Vida", "duration": 244, "url": "http:\/\/cs4488.vk.me\/u7843745\/audios\/033d4b56ab6e.mp3", "lyrics_id": "8392204", "album": "27635429" }, { "aid": 66707077, "owner_id": 37767384, "artist": "Coldplay", "title": "The Scientist", "duration": 308, "url": "http:\/\/cs4521.vk.me\/u37767384\/audios\/e3a88bf9bb5d.mp3", "lyrics_id": "2409748" }, { "aid": 76640409, "owner_id": 8453076, "artist": "Coldplay", "title": "Yellow", "duration": 265, "url": "http:\/\/cs4765.vk.me\/u8453076\/audios\/7b6b0877b0d3.mp3", "lyrics_id": "4496949", "album": "917570" }, { "aid": 89841380, "owner_id": 2589167, "artist": "Lady Gaga", "title": "Poker Face", "duration": 227, "url": "http:\/\/cs4196.vk.me\/u8981417\/audios\/755b3fbcef03.mp3", "lyrics_id": "7282328" }, { "aid": 96840370, "owner_id": 1223745, "artist": "Radiohead", "title": "Creep", "duration": 235, "url": "http:\/\/cs4901.vk.me\/u1223745\/audios\/89f88d5261c5.mp3", "lyrics_id": "5966942" }, { "aid": 38583864, "owner_id": 3334191, "artist": "Red Hot Chili Peppers", "title": "Californication", "duration": 321, "url": "http:\/\/cs1467.vk.me\/u11915060\/audios\/b6841ee2be47.mp3", "lyrics_id": "3237442", "album": "3204809" }, { "aid": 77621928, "owner_id": 8453076, "artist": "Coldplay", "title": "Fix You", "duration": 266, "url": "http:\/\/cs4648.vk.me\/u8453076\/audios\/d796aa815f66.mp3", "lyrics_id": "4714235", "album": "917570" }, { "aid": 93433161, "owner_id": 15944945, "artist": "Blur", "title": "Song 2", "duration": 121, "url": "http:\/\/cs4699.vk.me\/u15944945\/audios\/8e1b0297db75.mp3", "lyrics_id": "5203554", "album": "972618" }, { "aid": 103604487, "owner_id": 12140873, "artist": "System of a Down", "title": "Chop Suey!", "duration": 210, "url": "http:\/\/cs4849.vk.me\/u32985143\/audios\/8a50f916aace.mp3", "lyrics_id": "11203061" }, { "aid": 83642705, "owner_id": 6745278, "artist": "Snow Patrol", "title": "Chasing Cars", "duration": 265, "url": "http:\/\/cs4955.vk.me\/u6745278\/audios\/f08faaca1c27.mp3", "lyrics_id": "5649740" }, { "aid": 93681891, "owner_id": 574708, "artist": "Red Hot Chili Peppers", "title": "Under the Bridge ", "duration": 273, "url": "http:\/\/cs4490.vk.me\/u7540723\/audios\/bfa081281551.mp3", "lyrics_id": "3804163" }, { "aid": 77081177, "owner_id": 6895598, "artist": "Nirvana", "title": "Lithium", "duration": 255, "url": "http:\/\/cs4779.vk.me\/u6895598\/audios\/91a34924376a.mp3", "lyrics_id": "5438670" }, { "aid": 71073116, "owner_id": 20187403, "artist": "Muse", "title": "Starlight", "duration": 239, "url": "http:\/\/cs4625.vk.me\/u37893645\/audios\/f61352c5e936.mp3", "lyrics_id": "3502650" }, { "aid": 48819329, "owner_id": 3272633, "artist": "The Killers", "title": "When You Were Young", "duration": 220, "url": "http:\/\/cs1755.vk.me\/u3272633\/audios\/1035a2512721.mp3", "lyrics_id": "923509" }, { "aid": 40403700, "owner_id": 3178642, "artist": "Muse", "title": "Supermassive Black Hole", "duration": 209, "url": "http:\/\/cs1549.vk.me\/u3178642\/audios\/e0345f15e5db.mp3", "lyrics_id": "2503811" }, { "aid": 79664691, "owner_id": 63378505, "artist": "Ke$ha", "title": "TiK ToK", "duration": 201, "url": "http:\/\/cs4591.vk.me\/u63378505\/audios\/f04c21e4d4ec.mp3", "lyrics_id": "5421851" }, { "aid": 61235136, "owner_id": 11256, "artist": "Kings of Leon", "title": "Sex On Fire", "duration": 206, "url": "http:\/\/cs4265.vk.me\/u11256\/audios\/184f2c88bbfa.mp3", "lyrics_id": "1572529" }, { "aid": 137968062, "owner_id": 82587368, "artist": "MGMT", "title": "Time to Pretend", "duration": 261, "url": "http:\/\/cs5076.vk.me\/u15809954\/audios\/129260663ee2.mp3", "lyrics_id": "22685446" }, { "aid": 81448827, "owner_id": 6235545, "artist": "Red Hot Chili Peppers", "title": "Scar Tissue", "duration": 216, "url": "http:\/\/cs4545.vk.me\/u6235545\/audios\/0967613006fa.mp3", "lyrics_id": "2900397" }, { "aid": 84632219, "owner_id": 8086345, "artist": "Muse", "title": "Time Is Running Out", "duration": 237, "url": "http:\/\/cs4624.vk.me\/u34005245\/audios\/2f9605b2802d.mp3", "lyrics_id": "4498791", "album": "3280087" }, { "aid": 60886293, "owner_id": -5139236, "artist": "Grand Theft Auto", "title": "Billie Jean", "duration": 293, "url": "http:\/\/cs4192.vk.me\/u19494134\/audios\/04613f026814.mp3" }, { "aid": 99511351, "owner_id": 14529245, "artist": "Kanye West", "title": "Stronger", "duration": 312, "url": "http:\/\/cs4695.vk.me\/u30621345\/audios\/33be454220bb.mp3", "lyrics_id": "6666382" }];

    function getRandomTrack() {
        var randIndex = Math.floor((Math.random() * tracks.length));
        return tracks[randIndex];
    }

    var vkApi =
    {
        init: function(onComplete) {
            onComplete();
        },
        appendVkData: function (tracks, onSuccess) {
            var i,
                request = "";

            if (!$.isArray(tracks)) {
                request = tracks.appendVkRequest(request);
            } else {
                $.each(tracks, function () {
                    request = this.appendVkRequest(request);
                });
            }

            // stub VK response
            var vkData = {};
            var pairs = request.split(",");
            for (i = 0; i < pairs.length; i++) {
                var values = pairs[i].split("_");
                var stub = getRandomTrack();
                vkData[values[1]] = {
                    url: stub.url,
                    duration: stub.duration
                };
            }

            // obserb results
            if (!$.isArray(tracks)) {
                tracks.obserbVkData(vkData);
            } else {
                for (i = tracks.length - 1; i >= 0; i--) {
                    tracks[i].obserbVkData(vkData);
                    if (!tracks[i].url) {
                        tracks.splice(i, 1);
                    }
                }
            }

            onSuccess(tracks);
        }
    };

    return vkApi;
});